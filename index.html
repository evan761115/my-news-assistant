<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI 新聞小幫手</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 品牌色 */
        :root {
            --primary-blue: #3B427F;
            --secondary-orange: #F47920;
            --secondary-yellow: #F9BA1D;
            --secondary-light-blue: #67BCD2;
            --background-light: #F0F2F5;
            --card-light: #FFFFFF;
            --text-dark: #333333;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--background-light);
            color: var(--text-dark);
        }
        .container-card {
            background-color: var(--card-light);
            border: 1px solid #E0E0E0;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
        }
        .input-area, .output-area {
            background-color: var(--card-light);
        }
        .input-field, .output-field {
            background-color: #F8F9FA;
            border: 1px solid #E0E0E0;
            color: var(--text-dark);
        }
        .output-scroll::-webkit-scrollbar {
            width: 8px;
        }
        .output-scroll::-webkit-scrollbar-track {
            background: #E0E0E0;
            border-radius: 10px;
        }
        .output-scroll::-webkit-scrollbar-thumb {
            background: #BDBDBD;
            border-radius: 10px;
        }
        .output-scroll::-webkit-scrollbar-thumb:hover {
            background: #A0A0A0;
        }
        .custom-message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #4CAF50;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            font-size: 1rem;
            font-weight: 600;
        }
        .custom-message-box.show {
            display: block;
            opacity: 1;
        }
        /* 美化 input range */
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            background: var(--secondary-orange);
            cursor: pointer;
            border-radius: 9999px;
            box-shadow: 0 0 0 2px rgba(244, 121, 32, 0.5);
            transition: all 0.2s ease-in-out;
        }
        input[type="range"]::-moz-range-thumb {
            width: 18px;
            height: 18px;
            background: var(--secondary-orange);
            cursor: pointer;
            border-radius: 9999px;
            box-shadow: 0 0 0 2px rgba(244, 121, 32, 0.5);
            transition: all 0.2s ease-in-out;
        }
        .tab-button {
            transition: all 0.3s ease-in-out;
            transform: scale(1);
        }
        .tab-button.active {
            background-color: var(--secondary-light-blue);
            color: white;
            box-shadow: 0 4px 15px rgba(103, 188, 210, 0.4);
            transform: scale(1.05);
        }
        .tab-button:not(.active):hover {
            background-color: #E8F5FD;
            color: var(--secondary-light-blue);
        }
        .submit-button {
            background-color: var(--primary-blue);
        }
        .submit-button:hover {
            background-color: #2F3560;
        }
        .title-card {
            background-color: #F8F9FA;
            border: 1px solid #E0E0E0;
        }
    </style>
</head>
<body class="bg-[var(--background-light)] p-4 sm:p-8 text-[var(--text-dark)]">
    <div id="root"></div>
    <div id="message-box" class="custom-message-box"></div>
    <script type="module">
        import React from 'https://esm.sh/react@18.2.0';
        import ReactDOM from 'https://esm.sh/react-dom@18.2.0/client';
        const { useState, useCallback, useEffect } = React;
        import { ClipboardCopy, Loader, XCircle, PenTool, MessageSquare, User, Star, Link, Globe } from 'https://esm.sh/lucide-react@0.395.0';

        // 請在這裡填入您的 API 金鑰。請將 "YOUR_API_KEY_HERE" 替換成您的金鑰字串。
        // **注意：您的金鑰字串必須用雙引號 (") 完整地包住！**
        // 例如: const apiKey = "AIzaSyC-HI1V9n1kpqYuvuaWz6TlFUUkQ7FZPcc";
        const apiKey = "AIzaSyCjFGXup0Yy0mwCV8rQYazcKp9e2fmx3Fg";
        
        // 輔助函數：條件式 className
        function classNames(...classes) {
            return classes.filter(Boolean).join(' ');
        }
        // 輔助函數：顯示自定義訊息框
        const showMessage = (message, duration = 3000) => {
            const messageBox = document.getElementById('message-box');
            messageBox.textContent = message;
            messageBox.classList.add('show');
            setTimeout(() => {
                messageBox.classList.remove('show');
            }, duration);
        };
        
        // 主要應用程式元件
        const App = () => {
            // 狀態管理
            const [activeTab, setActiveTab] = useState('highlights');
            const [inputContent, setInputContent] = useState('');
            const [output, setOutput] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [error, setError] = useState(null);
            const [optimizedTitles, setOptimizedTitles] = useState(null);
            const [isBrandsFiltered, setIsBrandsFiltered] = useState(true);
            const [wordCount, setWordCount] = useState(300);
            const [paragraphCount, setParagraphCount] = useState(5);
            const [celebrityData, setCelebrityData] = useState({
                name: '',
                platform: '',
                content: '',
                imageDesc: '',
                link: '',
                notes: '',
            });
            const [newsRewriteData, setNewsRewriteData] = useState({
                source: '',
                content: '',
            });
            const [foreignNewsRewriteData, setForeignNewsRewriteData] = useState({
                source: '',
                content: '',
            });

            // 處理 API 請求，整合瀏覽功能與重試機制
            const handleAPIRequest = useCallback(async (prompt, schema) => {
                // 在這裡檢查 API 金鑰是否已經被設置
                if (!apiKey) {
                    const errorMessage = 'API 金鑰未填入。請在程式碼的 `const apiKey = "";` 中填入您的金鑰。';
                    setError(errorMessage);
                    setIsLoading(false);
                    return null;
                }

                setIsLoading(true);
                setError(null);
                setOutput('AI 正在努力生成中，請稍候...');
                setOptimizedTitles(null);
                
                // 為了排查問題，將完整提示詞輸出到 Console
                console.log('Sending prompt to API:', prompt);

                try {
                    const payload = {
                        contents: [{ role: "user", parts: [{ text: prompt }] }],
                        generationConfig: {
                            responseMimeType: "application/json",
                            responseSchema: schema
                        }
                    };

                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
                    
                    let response;
                    let result;
                    let retries = 0;
                    const maxRetries = 5;
                    const initialDelay = 1000;

                    while (retries < maxRetries) {
                        try {
                            response = await fetch(apiUrl, {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify(payload)
                            });

                            if (response.ok) {
                                result = await response.json();
                                break;
                            } else if (response.status === 429) {
                                console.warn(`API Rate Limit hit (429), retrying in ${initialDelay * Math.pow(2, retries)}ms...`);
                                const delay = initialDelay * Math.pow(2, retries);
                                retries++;
                                await new Promise(res => setTimeout(res, delay));
                            } else if (response.status === 403) {
                                const errorText = await response.text();
                                console.error('API 請求失敗，狀態碼 403。可能是因為輸入內容觸發了內容安全政策，或是 API Key 無效。完整的錯誤回應：', errorText);
                                throw new Error(`API 請求失敗，狀態碼: 403。請檢查輸入內容是否包含敏感詞彙或不當資訊，並確認您的 API Key 是否有效。`);
                            } else {
                                const errorText = await response.text();
                                console.error('API 請求失敗，狀態碼:', response.status, '完整的錯誤回應：', errorText);
                                throw new Error(`API 請求失敗，狀態碼: ${response.status} - ${response.statusText}`);
                            }
                        } catch (err) {
                            console.error(`Fetch attempt failed: ${err.message}. Retrying...`);
                            if (retries < maxRetries - 1) {
                                const delay = initialDelay * Math.pow(2, retries);
                                retries++;
                                await new Promise(res => setTimeout(res, delay));
                            } else {
                                throw err;
                            }
                        }
                    }

                    if (result && result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        
                        const jsonText = result.candidates[0].content.parts[0].text;
                        console.log('API Raw JSON Response:', jsonText);
                        return JSON.parse(jsonText);
                    } else {
                        throw new Error("AI 返回的內容格式不正確，或內容遺失。");
                    }
                } catch (err) {
                    console.error("API 呼叫時發生錯誤:", err);
                    setError(err.message);
                    return null;
                } finally {
                    setIsLoading(false);
                }
            }, []);

            // 所有功能的通用 JSON Schema
            const commonSchema = {
                type: "OBJECT",
                properties: {
                    "rewrittenText": { "type": "STRING" },
                    "optimizedTitles": {
                        "type": "OBJECT",
                        "properties": {
                            "長標": {
                                "type": "OBJECT",
                                "properties": {
                                    "正統": { "type": "STRING" },
                                    "藏標": { "type": "STRING" },
                                    "特別": { "type": "STRING" }
                                }
                            },
                            "短標": {
                                "type": "OBJECT",
                                "properties": {
                                    "正統": { "type": "STRING" },
                                    "藏標": { "type": "STRING" },
                                    "特別": { "type": "STRING" }
                                }
                            }
                        }
                    }
                }
            };

            // 根據不同 Tab 觸發不同的功能
            const handleSubmit = useCallback(async () => {
                let prompt = '';
                const schema = commonSchema;

                const basePrompt = `你是一位資深娛樂新聞記者，請以星光雲的娛樂新聞風格撰寫一篇新聞稿，並遵守以下規則：
                    1. 使用台灣繁體中文。
                    2. 如果原稿中有提到品牌名稱，請不要寫到，並使用中性詞彙替換。
                    3. 新聞稿分段撰寫，每段字數不超過 160 字。
                    4. 標題請提供三種不同風格：正統、藏標和特別。
                    5. 每種標題風格都要有兩種長度：長標 (25-30字) 和短標 (15-20字)。
                    6. 標題不能包含逗號，但可以使用驚嘆號或問號。
                    7. 請勿使用日期作為標題中的數字。`;

                switch (activeTab) {
                    case 'highlights':
                        if (!inputContent.trim()) { setError('請輸入新聞重點！'); return; }
                        prompt = `${basePrompt}
                        請將以下重點內容撰寫成新聞稿，並指定文章字數為 ${wordCount} 字，段落數為 ${paragraphCount} 段。
                        重點內容：
                        ${inputContent}
                        `;
                        break;
                    case 'rewrite':
                        if (!inputContent.trim()) { setError('請輸入通稿內容！'); return; }
                        const rewriteBrandFilter = isBrandsFiltered ? '請將品牌名稱濾掉，並使用通順的詞彙替代。' : '';
                        prompt = `${basePrompt}
                        請將以下通稿進行改寫。改寫時請著重於「刪去冗贅的部分、調整詞句和糾正錯字」，並盡量保持原文的內容和意圖。
                        ${rewriteBrandFilter}
                        通稿內容：
                        ${inputContent}
                        `;
                        break;
                    case 'news-link-rewrite':
                        if (!newsRewriteData.content.trim() || !newsRewriteData.source.trim()) { setError('請輸入新聞內容和新聞來源！'); return; }
                        const newsLinkBrandFilter = isBrandsFiltered ? '請將品牌名稱濾掉，並使用通順的詞彙替代。' : '';
                        prompt = `${basePrompt}
                        請將以下新聞內容改寫成一篇新稿，語氣保持客觀，並且在第二段開頭明確指出來源。
                        ${newsLinkBrandFilter}
                        改寫重點：不要用太多原文，但要保持核心資訊不變。
                        新聞來源：${newsRewriteData.source}
                        新聞內容：
                        ${newsRewriteData.content}
                        `;
                        break;
                    case 'foreign-news-link-rewrite':
                        if (!foreignNewsRewriteData.content.trim() || !foreignNewsRewriteData.source.trim()) { setError('請輸入新聞內容和新聞來源！'); return; }
                        const foreignNewsBrandFilter = isBrandsFiltered ? '請將品牌名稱濾掉，並使用通順的詞彙替代。' : '';
                        prompt = `${basePrompt}
                        請將以下外電新聞內容翻譯並改寫成一篇新稿，語氣保持客觀，並且在第二段開頭明確指出來源。
                        ${foreignNewsBrandFilter}
                        改寫重點：不要用太多原文，但要保持核心資訊不變。
                        外電來源：${foreignNewsRewriteData.source}
                        外電內容：
                        ${foreignNewsRewriteData.content}
                        `;
                        break;
                    case 'social-to-news':
                        if (!celebrityData.name || !celebrityData.content) { setError('請填寫藝人名稱和社群文章內容！'); return; }
                        prompt = `${basePrompt}
                        請將以下社群媒體內容撰寫成一篇新聞。
                        藝人名稱：${celebrityData.name}
                        社群平台：${celebrityData.platform}
                        文章內容：
                        ${celebrityData.content}
                        ${celebrityData.imageDesc ? `配圖描述：${celebrityData.imageDesc}` : ''}
                        ${celebrityData.link ? `原始社群連結：${celebrityData.link}` : ''}
                        ${celebrityData.notes ? `補充說明：${celebrityData.notes}` : ''}
                        `;
                        break;
                    default: return;
                }

                const result = await handleAPIRequest(prompt, schema);

                if (result) {
                    setOutput(result.rewrittenText);
                    setOptimizedTitles(result.optimizedTitles);
                } else {
                    setOutput(`功能執行失敗，錯誤：${error}`);
                    setOptimizedTitles(null);
                }
            }, [activeTab, inputContent, wordCount, paragraphCount, celebrityData, newsRewriteData, foreignNewsRewriteData, isBrandsFiltered, handleAPIRequest, error]);

            // 根據不同 Tab 取得 UI 內容
            const getTabContent = useCallback(() => {
                switch (activeTab) {
                    case 'highlights': return { inputLabel: "新聞重點內容:", inputPlaceholder: "請輸入採訪重點或是條列式內容...", outputLabel: "產出的 AI 新聞稿", buttonText: "啟動（生成新聞）" };
                    case 'rewrite': return { inputLabel: "通稿內容:", inputPlaceholder: "請輸入需要改寫的通稿內容...", outputLabel: "改寫後的 AI 新聞稿", buttonText: "啟動（改寫）" };
                    case 'social-to-news': return { inputLabel: "社群文章內容:", inputPlaceholder: "請輸入藝人社群文章內容...", outputLabel: "產出的 AI 新聞稿", buttonText: "啟動（社群轉新聞）" };
                    case 'news-link-rewrite': return { inputLabel: "新聞內容:", inputPlaceholder: "請輸入需要改寫的新聞內容...", outputLabel: "改寫後的 AI 新聞稿", buttonText: "啟動（新聞連結改寫）" };
                    case 'foreign-news-link-rewrite': return { inputLabel: "外電內容:", inputPlaceholder: "請輸入需要改寫的外電新聞內容...", outputLabel: "改寫後的 AI 新聞稿", buttonText: "啟動（外電連結改寫）" };
                    default: return {};
                }
            }, [activeTab]);

            const content = getTabContent();

            // 複製功能
            const copyToClipboard = useCallback((text) => {
                if (text) {
                    navigator.clipboard.writeText(text)
                        .then(() => showMessage('內容已複製到剪貼簿！'))
                        .catch(err => {
                            const textarea = document.createElement('textarea');
                            textarea.value = text;
                            document.body.appendChild(textarea);
                            textarea.select();
                            document.execCommand('copy');
                            document.body.removeChild(textarea);
                            showMessage('內容已複製到剪貼簿！');
                        });
                }
            }, []);

            // 渲染標題建議卡片
            const renderTitleCard = (titleType, titles) => (
                React.createElement('div', { className: "title-card p-6 rounded-xl transition-all hover:border-[var(--secondary-orange)] transform hover:scale-[1.02]" },
                    React.createElement('h4', { className: "text-lg font-bold text-[var(--text-dark)] mb-4 border-b border-[#E0E0E0] pb-2 flex items-center" }, 
                        React.createElement(Star, { className: "h-5 w-5 mr-2 text-[var(--secondary-yellow)]" }),
                        titleType
                    ),
                    React.createElement('ul', { className: "space-y-4" },
                        Object.entries(titles).map(([key, value]) => (
                            React.createElement('li', { key: key, className: "flex items-start text-gray-600 text-sm" },
                                React.createElement('span', { className: "flex-shrink-0 font-bold text-[var(--primary-blue)] mr-2 min-w-[40px]" }, key + '：'),
                                React.createElement('span', null, value)
                            )
                        ))
                    )
                )
            );

            // 主介面渲染
            return React.createElement('div', { className: "min-h-screen flex items-center justify-center p-4 sm:p-8" },
                React.createElement('div', { className: "w-full max-w-6xl container-card rounded-3xl overflow-hidden" },
                    React.createElement('div', { className: "p-8 border-b border-[#E0E0E0] bg-white" },
                        React.createElement('div', { className: "flex items-center space-x-4 mb-2" },
                            React.createElement('div', { className: "h-12 w-12 bg-[var(--primary-blue)] flex items-center justify-center rounded-xl" }, 
                                React.createElement('span', { className: "text-white text-2xl font-black tracking-widest" }, "ET")
                            ),
                             React.createElement('h3', { className: "text-3xl font-bold text-[var(--primary-blue)]" }, "AI 新聞小幫手")
                        ),
                        React.createElement('p', { className: "text-base text-gray-500" }, "整合多項新聞生成功能，讓您的內容創作更有效率。")
                    ),
                    
                    React.createElement('div', { className: "p-6 sm:p-8" },
                        // 按鈕區塊 - 重新設計為水平置中
                        React.createElement('div', { className: "flex flex-wrap justify-center gap-4 mb-8 p-2 rounded-full bg-[#E8F5FD] shadow-inner" },
                            ['highlights', 'rewrite', 'news-link-rewrite', 'foreign-news-link-rewrite', 'social-to-news'].map(tab => (
                                React.createElement('button', {
                                    key: tab,
                                    className: classNames(
                                        "flex items-center px-4 py-3 text-sm font-semibold rounded-full tab-button",
                                        activeTab === tab ? "active" : "text-gray-600"
                                    ),
                                    onClick: () => {
                                        setActiveTab(tab);
                                        setError(null);
                                        setOptimizedTitles(null);
                                        setOutput('');
                                        setInputContent('');
                                        setCelebrityData({ name: '', platform: '', content: '', imageDesc: '', link: '', notes: '' });
                                        setNewsRewriteData({ source: '', content: '' });
                                        setForeignNewsRewriteData({ source: '', content: '' });
                                    }
                                },
                                    tab === 'highlights' && React.createElement(MessageSquare, { className: "mr-2 h-4 w-4" }),
                                    tab === 'rewrite' && React.createElement(PenTool, { className: "mr-2 h-4 w-4" }),
                                    tab === 'news-link-rewrite' && React.createElement(Link, { className: "mr-2 h-4 w-4" }),
                                    tab === 'foreign-news-link-rewrite' && React.createElement(Globe, { className: "mr-2 h-4 w-4" }),
                                    tab === 'social-to-news' && React.createElement(User, { className: "mr-2 h-4 w-4" }),
                                    tab === 'highlights' ? "重點轉新聞" : tab === 'rewrite' ? "通稿改寫" : tab === 'news-link-rewrite' ? "新聞連結改寫" : tab === 'foreign-news-link-rewrite' ? "外電連結改寫" : "社群轉新聞"
                                )
                            ))
                        ),

                        React.createElement('div', { className: "grid grid-cols-1 lg:grid-cols-2 gap-8" },
                            // 左側輸入區
                            React.createElement('div', { className: "input-area p-6 rounded-xl" },
                                (activeTab === 'highlights' || activeTab === 'rewrite') && (
                                    React.createElement('div', { className: "space-y-6" },
                                        React.createElement('div', { className: "space-y-2" },
                                            React.createElement('label', { className: "text-sm font-semibold text-gray-700" }, content.inputLabel),
                                            React.createElement('textarea', {
                                                className: "input-field w-full p-4 h-64 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--secondary-orange)] transition-all",
                                                placeholder: content.inputPlaceholder,
                                                value: inputContent,
                                                onChange: (e) => setInputContent(e.target.value)
                                            })
                                        ),
                                        activeTab === 'highlights' && (
                                            React.createElement('div', { className: "grid grid-cols-1 sm:grid-cols-2 gap-4" },
                                                React.createElement('div', { className: "space-y-2" },
                                                    React.createElement('label', { className: "text-sm font-semibold text-gray-700" }, `文章字數：${wordCount} 字`),
                                                    React.createElement('input', {
                                                        type: 'range',
                                                        min: '100', max: '800', step: '50',
                                                        value: wordCount,
                                                        onChange: (e) => setWordCount(parseInt(e.target.value)),
                                                        className: "w-full h-2 bg-[#E0E0E0] rounded-lg appearance-none cursor-pointer"
                                                    })
                                                ),
                                                React.createElement('div', { className: "space-y-2" },
                                                    React.createElement('label', { className: "text-sm font-semibold text-gray-700" }, `段落數：${paragraphCount} 段`),
                                                    React.createElement('input', {
                                                        type: 'range',
                                                        min: '2', max: '10', step: '1',
                                                        value: paragraphCount,
                                                        onChange: (e) => setParagraphCount(parseInt(e.target.value)),
                                                        className: "w-full h-2 bg-[#E0E0E0] rounded-lg appearance-none cursor-pointer"
                                                    })
                                                )
                                            )
                                        ),
                                        (activeTab === 'rewrite' || activeTab === 'news-link-rewrite' || activeTab === 'foreign-news-link-rewrite') && (
                                            React.createElement('div', { className: "flex items-center space-x-2" },
                                                React.createElement('input', {
                                                    type: 'checkbox', id: 'isBrandsFiltered',
                                                    checked: isBrandsFiltered,
                                                    onChange: (e) => setIsBrandsFiltered(e.target.checked),
                                                    className: 'form-checkbox h-4 w-4 text-[var(--secondary-orange)] rounded-md bg-[#F8F9FA] border-[#E0E0E0] focus:ring-[var(--secondary-orange)] transition-all'
                                                }),
                                                React.createElement('label', { htmlFor: "isBrandsFiltered", className: "text-sm text-gray-700" }, "是否過濾品牌名稱")
                                            )
                                        )
                                    )
                                ),
                                (activeTab === 'news-link-rewrite' || activeTab === 'foreign-news-link-rewrite') && (
                                    React.createElement('div', { className: "space-y-4" },
                                        React.createElement('div', { className: "space-y-2" },
                                            React.createElement('label', { className: "text-sm font-semibold text-gray-700" }, "新聞來源:"),
                                            React.createElement('input', {
                                                type: 'text', className: "input-field w-full p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--secondary-orange)] transition-all",
                                                placeholder: "如：聯合新聞網、ETtoday",
                                                value: activeTab === 'news-link-rewrite' ? newsRewriteData.source : foreignNewsRewriteData.source,
                                                onChange: (e) => activeTab === 'news-link-rewrite' ? setNewsRewriteData({ ...newsRewriteData, source: e.target.value }) : setForeignNewsRewriteData({ ...foreignNewsRewriteData, source: e.target.value })
                                            })
                                        ),
                                        React.createElement('div', { className: "space-y-2" },
                                            React.createElement('label', { className: "text-sm font-semibold text-gray-700" }, content.inputLabel),
                                            React.createElement('textarea', {
                                                className: "input-field w-full p-4 h-64 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--secondary-orange)] transition-all",
                                                placeholder: content.inputPlaceholder,
                                                value: activeTab === 'news-link-rewrite' ? newsRewriteData.content : foreignNewsRewriteData.content,
                                                onChange: (e) => activeTab === 'news-link-rewrite' ? setNewsRewriteData({ ...newsRewriteData, content: e.target.value }) : setForeignNewsRewriteData({ ...foreignNewsRewriteData, content: e.target.value })
                                            })
                                        ),
                                        React.createElement('div', { className: "flex items-center space-x-2" },
                                            React.createElement('input', {
                                                type: 'checkbox', id: 'isBrandsFiltered2',
                                                checked: isBrandsFiltered,
                                                onChange: (e) => setIsBrandsFiltered(e.target.checked),
                                                className: 'form-checkbox h-4 w-4 text-[var(--secondary-orange)] rounded-md bg-[#F8F9FA] border-[#E0E0E0] focus:ring-[var(--secondary-orange)] transition-all'
                                            }),
                                            React.createElement('label', { htmlFor: "isBrandsFiltered2", className: "text-sm text-gray-700" }, "是否過濾品牌名稱")
                                        )
                                    )
                                ),
                                activeTab === 'social-to-news' && (
                                    React.createElement('div', { className: "space-y-4" },
                                        React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 gap-4" },
                                            React.createElement('div', { className: "space-y-2" },
                                                React.createElement('label', { className: "text-sm font-semibold text-gray-700" }, "藝人名稱"),
                                                React.createElement('input', {
                                                    type: 'text', className: "input-field w-full p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--secondary-orange)] transition-all",
                                                    placeholder: "如：蔡依林", value: celebrityData.name,
                                                    onChange: (e) => setCelebrityData({...celebrityData, name: e.target.value})
                                                })
                                            ),
                                            React.createElement('div', { className: "space-y-2" },
                                                React.createElement('label', { className: "text-sm font-semibold text-gray-700" }, "社群平台"),
                                                React.createElement('input', {
                                                    type: 'text', className: "input-field w-full p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--secondary-orange)] transition-all",
                                                    placeholder: "如：Instagram、Facebook", value: celebrityData.platform,
                                                    onChange: (e) => setCelebrityData({...celebrityData, platform: e.target.value})
                                                })
                                            )
                                        ),
                                        React.createElement('div', { className: "space-y-2" },
                                            React.createElement('label', { className: "text-sm font-semibold text-gray-700" }, "社群文章內容"),
                                            React.createElement('textarea', {
                                                className: "input-field w-full p-4 h-48 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--secondary-orange)] transition-all",
                                                placeholder: "請輸入藝人發佈的原文內容...", value: celebrityData.content,
                                                onChange: (e) => setCelebrityData({...celebrityData, content: e.target.value})
                                            })
                                        ),
                                        React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 gap-4" },
                                            React.createElement('div', { className: "space-y-2" },
                                                React.createElement('label', { className: "text-sm font-semibold text-gray-700" }, "配圖描述 (選填)"),
                                                React.createElement('input', {
                                                    type: 'text', className: "input-field w-full p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--secondary-orange)] transition-all",
                                                    placeholder: "如：穿著黑色禮服在紅毯上", value: celebrityData.imageDesc,
                                                    onChange: (e) => setCelebrityData({...celebrityData, imageDesc: e.target.value})
                                                })
                                            ),
                                            React.createElement('div', { className: "space-y-2" },
                                                React.createElement('label', { className: "text-sm font-semibold text-gray-700" }, "原始社群連結 (選填)"),
                                                React.createElement('input', {
                                                    type: 'url', className: "input-field w-full p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--secondary-orange)] transition-all",
                                                    placeholder: "如：https://www.instagram.com/...", value: celebrityData.link,
                                                    onChange: (e) => setCelebrityData({...celebrityData, link: e.target.value})
                                                })
                                            )
                                        ),
                                        React.createElement('div', { className: "space-y-2" },
                                            React.createElement('label', { className: "text-sm font-semibold text-gray-700" }, "補充說明 (選填)"),
                                            React.createElement('textarea', {
                                                className: "input-field w-full p-3 h-24 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--secondary-orange)] transition-all",
                                                placeholder: "如有其他相關資訊可在此補充...", value: celebrityData.notes,
                                                onChange: (e) => setCelebrityData({...celebrityData, notes: e.target.value})
                                            })
                                        )
                                    )
                                )
                            ),

                            // 右側輸出區
                            React.createElement('div', { className: "output-area p-6 rounded-xl" },
                                React.createElement('div', { className: "space-y-4" },
                                    React.createElement('div', { className: "space-y-2" },
                                        React.createElement('div', { className: "flex items-center justify-between" },
                                            React.createElement('label', { className: "text-sm font-semibold text-gray-700" }, content.outputLabel),
                                            React.createElement('button', {
                                                className: "flex items-center text-gray-600 hover:text-[var(--secondary-orange)] transition-colors disabled:opacity-50",
                                                onClick: () => copyToClipboard(output),
                                                disabled: !output || isLoading
                                            }, React.createElement(ClipboardCopy, { className: "mr-2 h-4 w-4" }), "複製")
                                        ),
                                        React.createElement('div', {
                                            className: "output-field w-full h-80 overflow-y-auto p-4 text-sm rounded-lg output-scroll",
                                            dangerouslySetInnerHTML: { __html: output.replace(/\n/g, '<br />') }
                                        })
                                    ),
                                    optimizedTitles && React.createElement('div', { className: "space-y-4 mt-8" },
                                        React.createElement('label', { className: "text-lg font-bold text-[var(--text-dark)]" }, "優化後的標題建議"),
                                        React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 gap-4" },
                                            renderTitleCard("長標 (25-30 字)", optimizedTitles.長標),
                                            renderTitleCard("短標 (15-20 字)", optimizedTitles.短標)
                                        )
                                    )
                                )
                            )
                        ),

                        // 啟動按鈕
                        React.createElement('div', { className: "mt-8" },
                            error && React.createElement('div', { className: "flex items-center p-3 bg-red-100 text-red-800 rounded-lg mb-4" },
                                React.createElement(XCircle, { className: "h-5 w-5 mr-2" }),
                                React.createElement('span', { className: "text-sm" }, `發生錯誤：${error}`)
                            ),
                            React.createElement('button', {
                                className: "w-full flex items-center justify-center p-4 font-semibold rounded-lg text-white submit-button hover:opacity-90 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",
                                onClick: handleSubmit,
                                disabled: isLoading || (!inputContent.trim() && (activeTab === 'highlights' || activeTab === 'rewrite')) ||
                                          (!celebrityData.content.trim() && activeTab === 'social-to-news') ||
                                          (!newsRewriteData.content.trim() && activeTab === 'news-link-rewrite') ||
                                          (!foreignNewsRewriteData.content.trim() && activeTab === 'foreign-news-link-rewrite')
                            },
                                isLoading && React.createElement(Loader, { className: "mr-2 h-5 w-5 animate-spin" }),
                                content.buttonText
                            )
                        )
                    )
                )
            );
        };

        ReactDOM.createRoot(document.getElementById('root')).render(React.createElement(App));
    </script>
</body>
</html>
